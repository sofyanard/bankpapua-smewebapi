<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/bootstrap-select.min.css">

    <title>Hello, world!</title>
</head>
<body>
    <div class="container">
        <p>
            <a href="Index.html">Index</a>
        </p>

        <h1>SiteVisit - Rumah</h1>

        <br />

        <form>
            <div class="form-group">
                <label for="token">Token</label>
                <input type="text" class="form-control" id="token" name="token">
            </div>

            <div class="form-group">
                <label for="apRegno">ApRegno</label>
                <select class="form-control" id="apRegno" name="apRegno"></select>
            </div>

            <input type="hidden" id="cuRef" name="cuRef">

            <div class="form-group">
                <label for="tanggalInvestigasi">Tanggal Investigasi</label>
                <input type="date" class="form-control" id="tanggalInvestigasi" name="tanggalInvestigasi">
            </div>

            <div class="form-group">
                <label for="namaPemberiKeterangan1">Nama Pemberi Keterangan 1</label>
                <input type="text" class="form-control" id="namaPemberiKeterangan1" name="namaPemberiKeterangan1">
            </div>

            <div class="form-group">
                <label for="hubunganPemberiKeterangan1">Hubungan Pemberi Keterangan 1</label>
                <select class="form-control" id="hubunganPemberiKeterangan1" name="hubunganPemberiKeterangan1"></select>
            </div>

            <div class="form-group">
                <label for="namaPemberiKeterangan2">Nama Pemberi Keterangan 2</label>
                <input type="text" class="form-control" id="namaPemberiKeterangan2" name="namaPemberiKeterangan2">
            </div>

            <div class="form-group">
                <label for="hubunganPemberiKeterangan2">Hubungan Pemberi Keterangan 2</label>
                <select class="form-control" id="hubunganPemberiKeterangan2" name="hubunganPemberiKeterangan2"></select>
            </div>

            <div class="form-group">
                <label for="statusRumah">Status Rumah</label>
                <select class="form-control" id="statusRumah" name="statusRumah"></select>
            </div>

            <div class="form-group">
                <label for="cekBerdasarkanX">Cek Berdasarkan X</label>
                <input type="text" class="form-control" id="cekBerdasarkanX" name="cekBerdasarkanX">
            </div>

            <div class="form-group">
                <label for="rumahSebagaiAgunanX">Rumah Sebagai Agunan X</label>
                <input type="text" class="form-control" id="rumahSebagaiAgunanX" name="rumahSebagaiAgunanX">
            </div>

            <div class="form-group">
                <label for="lamaMenetapTahun">Lama Menetap Tahun</label>
                <input type="text" class="form-control" id="LamaMenetapTahun" name="LamaMenetapTahun">
            </div>

            <div class="form-group">
                <label for="lamaMenetapBulan">Lama Menetap Bulan</label>
                <input type="text" class="form-control" id="lamaMenetapBulan" name="lamaMenetapBulan">
            </div>

            <div class="form-group">
                <label for="jenisBangunan">Jenis Bangunan</label>
                <select class="form-control" id="jenisBangunan" name="jenisBangunan"></select>
            </div>

            <div class="form-group">
                <label for="lokasiBangunan">Lokasi Bangunan</label>
                <select class="form-control" id="lokasiBangunan" name="lokasiBangunan"></select>
            </div>

            <div class="form-group">
                <label for="kondisiBangunan">Kondisi Bangunan</label>
                <select class="form-control" id="kondisiBangunan" name="kondisiBangunan"></select>
            </div>

            <div class="form-group">
                <label for="fasilitasRumah">Fasilitas Rumah</label>
                <select class="form-control" id="fasilitasRumah" name="fasilitasRumah"></select>
            </div>

            <div class="form-group">
                <label for="isiRumahX">Isi Rumah X</label>
                <input type="text" class="form-control" id="isiRumahX" name="isiRumahX">
            </div>

            <div class="form-group">
                <label for="aksesJalan">Akses Jalan</label>
                <select class="form-control" id="aksesJalan" name="aksesJalan"></select>
            </div>

            <div class="form-group">
                <label for="kondisiLingkungan">Kondisi Lingkungan</label>
                <select class="form-control" id="kondisiLingkungan" name="kondisiLingkungan"></select>
            </div>

            <div class="form-group">
                <label for="luasTanah">Luas Tanah</label>
                <input type="text" class="form-control" id="luasTanah" name="luasTanah">
            </div>

            <div class="form-group">
                <label for="luasBangunan">Luas Bangunan</label>
                <input type="text" class="form-control" id="luasBangunan" name="luasBangunan">
            </div>

            <div class="form-group">
                <label for="garasi">Garasi</label>
                <input type="text" class="form-control" id="garasi" name="garasi">
            </div>

            <div class="form-group">
                <label for="carport">Carport</label>
                <input type="text" class="form-control" id="carport" name="carport">
            </div>

            <div class="form-group">
                <label for="kendaraan">Kendaraan</label>
                <input type="text" class="form-control" id="kendaraan" name="kendaraan">
            </div>

            <div class="form-group">
                <label for="alamatSesuaiKTPX">Alamat Sesuai KTP X</label>
                <input type="text" class="form-control" id="alamatSesuaiKTPX" name="alamatSesuaiKTPX">
            </div>

            <div class="form-group">
                <label for="teleponDapatDihubungiX">Telepon Dapat Dihubungi X</label>
                <input type="text" class="form-control" id="teleponDapatDihubungiX" name="teleponDapatDihubungiX">
            </div>

            <br />

            <div class="row">
                <div class="col-md-3">
                    <button type="button" class="btn btn-primary" id="getall" name="getid">GET ALL</button>
                </div>
                <div class="col-md-3">
                    <button type="button" class="btn btn-primary" id="get" name="get">GET / ID</button>
                </div>
                <div class="col-md-3">
                    <button type="button" class="btn btn-primary" id="put" name="put">PUT / ID</button>
                </div>
                <div class="col-md-3">
                    <button type="button" class="btn btn-primary" id="post" name="post">POST</button>
                </div>
            </div>

            <br />

            <div class="row">
                <div class="col-md-3">

                </div>
                <div class="col-md-3">

                </div>
                <div class="col-md-3">
                    <button type="button" class="btn btn-secondary" id="upload" name="upload">UPLOAD / ID</button>
                </div>
                <div class="col-md-3">

                </div>
            </div>

        </form>

        <br />

        <div class="alert alert-success alert-dismissible" role="alert" id="divsuccess">
            <span id="msgsuccess"></span>
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>

        <div class="alert alert-danger alert-dismissible" role="alert" id="diverror">
            <span id="msgerror"></span>
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>

        <div class="alert alert-info alert-dismissible" role="alert" id="divcomplete">
            <span id="msgcomplete"></span>
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="js/jquery-3.5.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/bootstrap-select.min.js"></script>

    <script>
        $(document).ready(function () {
            $('#divsuccess').hide();
            $('#diverror').hide();
            $('#divcomplete').hide();

            // Relationship
            $.ajax({
                url: '../api/parameter/relationship',
                contentType: 'application/json',
                success: function (result) {
                    $.each(result, function () {
                        $('#hubunganPemberiKeterangan1').append($("<option />").val(this.RelationshipId).text(this.RelationshipDesc));
                        $('#hubunganPemberiKeterangan2').append($("<option />").val(this.RelationshipId).text(this.RelationshipDesc));
                    });
                }
            });

            // Status Rumah
            $.ajax({
                url: '../api/parameter/homestatus',
                contentType: 'application/json',
                success: function (result) {
                    $.each(result, function () {
                        $('#statusRumah').append($("<option />").val(this.HomeStatusId).text(this.HomeStatusDesc));
                    });
                }
            });

            // Jenis Bangunan
            $.ajax({
                url: '../api/parameter/apprjenisbangunan',
                contentType: 'application/json',
                success: function (result) {
                    $.each(result, function () {
                        $('#jenisBangunan').append($("<option />").val(this.BangunanId).text(this.BangunanDesc));
                    });
                }
            });

            // Lokasi Bangunan
            // Kondisi Lingkungan
            $.ajax({
                url: '../api/parameter/apprlokasibangunan',
                contentType: 'application/json',
                success: function (result) {
                    $.each(result, function () {
                        $('#lokasiBangunan').append($("<option />").val(this.LokasiId).text(this.LokasiDesc));
                        $('#kondisiLingkungan').append($("<option />").val(this.LokasiId).text(this.LokasiDesc));
                    });
                }
            });

            // Kondisi Bangunan
            $.ajax({
                url: '../api/parameter/apprpenggunaanbangunan',
                contentType: 'application/json',
                success: function (result) {
                    $.each(result, function () {
                        $('#kondisiBangunan').append($("<option />").val(this.GunaId).text(this.GunaDesc));
                    });
                }
            });

            // Fasilitas Rumah
            $.ajax({
                url: '../api/parameter/apprkelengkapan',
                contentType: 'application/json',
                success: function (result) {
                    $.each(result, function () {
                        $('#fasilitasRumah').append($("<option />").val(this.LengkapId).text(this.LengkapDesc));
                    });
                }
            });

            // Akses Jalan
            $.ajax({
                url: '../api/parameter/apprjalan',
                contentType: 'application/json',
                success: function (result) {
                    $.each(result, function () {
                        $('#aksesJalan').append($("<option />").val(this.JalanId).text(this.JalanDesc));
                    });
                }
            });

            // GET ALL
            $('#getall').click(function () {
                $.ajax({
                    url: '../api/sitevisitrumah',
                    type: 'GET',
                    headers: {
                        "Authorization": "Bearer " + $('#token').val()
                    },
                    contentType: 'application/json',
                    success: function (result) {
                        $('#divsuccess').show();
                        $('#msgsuccess').html(JSON.stringify(result));

                        $('#apRegno').empty();
                        $.each(result, function () {
                            $('#apRegno').append($("<option />").val(this.ApRegno).text(this.ApRegno));
                        });
                    },
                    error: function error(xhr, status, error) {
                        $('#diverror').show();
                        $('#msgerror').html(xhr.responseText);
                    },
                    complete: function (xhr, status) {
                        $('#divcomplete').show();
                        $('#msgcomplete').html(xhr.status);
                    }
                });
            });

            // GET / ID
            $('#get').click(function () {
                $.ajax({
                    url: '../api/sitevisitrumah/' + $('#apRegno').val(),
                    type: 'GET',
                    headers: {
                        "Authorization": "Bearer " + $('#token').val()
                    },
                    contentType: 'application/json',
                    success: function (result) {
                        $('#divsuccess').show();
                        $('#msgsuccess').html(JSON.stringify(result));

                        $('#cuRef').val(result.CuRef);
                        $('#tanggalInvestigasi').val(result.TanggalInvestigasi);
                        $('#namaPemberiKeterangan1').val(result.NamaPemberiKeterangan1);
                        $('#hubunganPemberiKeterangan1').val(result.HubunganPemberiKeterangan1);
                        $('#namaPemberiKeterangan2').val(result.NamaPemberiKeterangan2);
                        $('#hubunganPemberiKeterangan2').val(result.HubunganPemberiKeterangan2);
                        $('#statusRumah').val(result.StatusRumah);
                        $('#cekBerdasarkanX').val(result.CekBerdasarkanX);
                        $('#rumahSebagaiAgunanX').val(result.RumahSebagaiAgunanX);
                        $('#lamaMenetapTahun').val(result.LamaMenetapTahun);
                        $('#lamaMenetapBulan').val(result.LamaMenetapBulan);
                        $('#jenisBangunan').val(result.JenisBangunan);
                        $('#lokasiBangunan').val(result.LokasiBangunan);
                        $('#kondisiBangunan').val(result.KondisiBangunan);
                        $('#fasilitasRumah').val(result.FasilitasRumah);
                        $('#isiRumahX').val(result.IsiRumahX);
                        $('#aksesJalan').val(result.AksesJalan);
                        $('#kondisiLingkungan').val(result.KondisiLingkungan);
                        $('#luasTanah').val(result.LuasTanah);
                        $('#luasBangunan').val(result.LuasBangunan);
                        $('#garasi').val(result.Garasi);
                        $('#carport').val(result.Carport);
                        $('#kendaraan').val(result.Kendaraan);
                    },
                    error: function error(xhr, status, error) {
                        $('#diverror').show();
                        $('#msgerror').html(xhr.responseText);
                    },
                    complete: function (xhr, status) {
                        $('#divcomplete').show();
                        $('#msgcomplete').html(xhr.status);
                    }
                });
            });

            // PUT / ID
            $('#put').click(function () {

                var data = JSON.stringify({
                    ApRegno: $('#apRegno').val(),
                    CuRef: $('#cuRef').val(),
                    TanggalInvestigasi: $('#tanggalInvestigasi').val(),
                    NamaPemberiKeterangan1: $('#namaPemberiKeterangan1').val(),
                    HubunganPemberiKeterangan1: $('#hubunganPemberiKeterangan1').val(),
                    NamaPemberiKeterangan2: $('#namaPemberiKeterangan2').val(),
                    HubunganPemberiKeterangan2: $('#hubunganPemberiKeterangan2').val(),
                    StatusRumah: $('#statusRumah').val(),
                    CekBerdasarkanX: $('#cekBerdasarkanX').val(),
                    RumahSebagaiAgunanX: $('#rumahSebagaiAgunanX').val(),
                    LamaMenetapTahun: $('#lamaMenetapTahun').val(),
                    LamaMenetapBulan: $('#lamaMenetapBulan').val(),
                    JenisBangunan: $('#jenisBangunan').val(),
                    LokasiBangunan: $('#lokasiBangunan').val(),
                    KondisiBangunan: $('#kondisiBangunan').val(),
                    FasilitasRumah: $('#fasilitasRumah').val(),
                    IsiRumahX: $('#isiRumahX').val(),
                    AksesJalan: $('#aksesJalan').val(),
                    KondisiLingkungan: $('#KondisiLingkungan').val(),
                    LuasTanah: $('#luasTanah').val(),
                    LuasBangunan: $('#luasBangunan').val(),
                    Garasi: $('#garasi').val(),
                    Carport: $('#carport').val(),
                    Kendaraan: $('#kendaraan').val()
                });

                $.ajax({
                    url: '../api/sitevisitrumah/' + $('#apRegno').val(),
                    type: 'PUT',
                    headers: {
                        "Authorization": "Bearer " + $('#token').val()
                    },
                    contentType: 'application/json',
                    data: data,
                    success: function (result) {
                        $('#divsuccess').show();
                        $('#msgsuccess').html(JSON.stringify(result));


                    },
                    error: function error(xhr, status, error) {
                        $('#diverror').show();
                        $('#msgerror').html(xhr.responseText);
                    },
                    complete: function (xhr, status) {
                        $('#divcomplete').show();
                        $('#msgcomplete').html(xhr.status);
                    }
                });
            });

            // POST
            $('#post').click(function () {

                var data = JSON.stringify({
                    ApRegno: $('#apRegno').val(),
                    CuRef: $('#cuRef').val(),
                    TanggalInvestigasi: $('#tanggalInvestigasi').val(),
                    NamaPemberiKeterangan1: $('#namaPemberiKeterangan1').val(),
                    HubunganPemberiKeterangan1: $('#hubunganPemberiKeterangan1').val(),
                    NamaPemberiKeterangan2: $('#namaPemberiKeterangan2').val(),
                    HubunganPemberiKeterangan2: $('#hubunganPemberiKeterangan2').val(),
                    StatusRumah: $('#statusRumah').val(),
                    CekBerdasarkanX: $('#cekBerdasarkanX').val(),
                    RumahSebagaiAgunanX: $('#rumahSebagaiAgunanX').val(),
                    LamaMenetapTahun: $('#lamaMenetapTahun').val(),
                    LamaMenetapBulan: $('#lamaMenetapBulan').val(),
                    JenisBangunan: $('#jenisBangunan').val(),
                    LokasiBangunan: $('#lokasiBangunan').val(),
                    KondisiBangunan: $('#kondisiBangunan').val(),
                    FasilitasRumah: $('#fasilitasRumah').val(),
                    IsiRumahX: $('#isiRumahX').val(),
                    AksesJalan: $('#aksesJalan').val(),
                    KondisiLingkungan: $('#KondisiLingkungan').val(),
                    LuasTanah: $('#luasTanah').val(),
                    LuasBangunan: $('#luasBangunan').val(),
                    Garasi: $('#garasi').val(),
                    Carport: $('#carport').val(),
                    Kendaraan: $('#kendaraan').val()
                });

                $.ajax({
                    url: '../api/sitevisitrumah',
                    type: 'POST',
                    headers: {
                        "Authorization": "Bearer " + $('#token').val()
                    },
                    contentType: 'application/json',
                    // dataType: 'application/json',
                    data: data,
                    success: function (result) {
                        $('#divsuccess').show();
                        $('#msgsuccess').html(JSON.stringify(result));


                    },
                    error: function error(xhr, status, error) {
                        $('#diverror').show();
                        $('#msgerror').html(xhr.responseText);
                    },
                    complete: function (xhr, status) {
                        $('#divcomplete').show();
                        $('#msgcomplete').html(xhr.status);
                    }
                });
            });

            // UPLOAD / ID
            $('#upload').click(function () {
                if ($('#apRegno').val() == null) {
                    alert('ApRegno harus dipilih!');
                    return;
                }
                window.location.replace('../test/SiteVisitUpload.html?apregno=' + $('#apRegno').val());
            });

        });
    </script>
</body>
</html>